Slip 16

Q1.Display all the files from current directory which are created in particular month

#include <stdio.h>
#include <dirent.h>
#include <string.h>
#include <sys/stat.h>
#include <time.h>
#include <stdlib.h>

int main(int argc, char *argv[]) {
    char mon[100];
    DIR *dp;
    struct dirent *ep;
    struct stat sb;
    
    // Check if the target month is provided as a command-line argument
    if (argc != 2) {
        fprintf(stderr, "Usage: %s <target_month>\n", argv[0]);
        exit(EXIT_FAILURE);
    }
    
    // Validate the month input
    char *valid_months[] = {"Jan", "Feb", "Mar", "Apr", "May", "Jun", 
                             "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"};
    int valid = 0;
    for (int i = 0; i < 12; i++) {
        if (strcmp(argv[1], valid_months[i]) == 0) {
            valid = 1;
            break;
        }
    }
    
    if (!valid) {
        fprintf(stderr, "Invalid month: %s\n", argv[1]);
        exit(EXIT_FAILURE);
    }

    dp = opendir("./");
    if (dp != NULL) {
        while ((ep = readdir(dp)) != NULL) {
            // Skip directories (we only want regular files)
            if (ep->d_type != DT_REG) {
                continue;
            }

            // Construct the full path to the file
            if (stat(ep->d_name, &sb) == -1) {
                perror("stat");
                exit(EXIT_FAILURE);
            }
            
            // Convert the file's creation time (or last modification time) to a formatted string
            strftime(mon, sizeof(mon), "%b", localtime(&sb.st_mtime));
            
            // If the month matches, print the file name and time
            if (strcmp(mon, argv[1]) == 0) {
                printf("%s\t\t%s", ep->d_name, ctime(&sb.st_mtime));
            }
        }
        (void)closedir(dp);
    } else {
        perror("opendir");
        exit(EXIT_FAILURE);
    }
    
    return 0;
}

gcc slip16_1.c -o slip16_1
./slip16_1 Dec


Q2. Write a C program which create a child process which catch a signal sighup, sigint and sigquit. The Parent process send a sighup or sigint signal after every 3 seconds, at the end of 30 second parent send sigquit signal to child and child terminates my displaying message “My DADDY has Killed me!!!”.

#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <signal.h>
#include <string.h>

// Signal handler for SIGHUP
void handle_sighup(int sig) {
    printf("Child received SIGHUP signal\n");
}

// Signal handler for SIGINT
void handle_sigint(int sig) {
    printf("Child received SIGINT signal\n");
}

// Signal handler for SIGQUIT
void handle_sigquit(int sig) {
    printf("Child received SIGQUIT signal. My DADDY has Killed me!!!\n");
    exit(0);  // Terminate the child process after receiving SIGQUIT
}

int main() {
    pid_t pid = fork();  // Create child process

    if (pid < 0) {
        perror("Fork failed");
        exit(1);
    }

    if (pid == 0) {
        // Child process
        // Set up signal handlers
        signal(SIGHUP, handle_sighup);
        signal(SIGINT, handle_sigint);
        signal(SIGQUIT, handle_sigquit);

        printf("Child process started with PID: %d\n", getpid());
        
        // Infinite loop to keep the child process running
        while (1) {
            pause();  // Wait for signals
        }
    } else {
        // Parent process
        printf("Parent process started with PID: %d\n", getpid());
        
        // Send SIGHUP or SIGINT signal to child every 3 seconds
        for (int i = 0; i < 10; i++) {
            if (i % 2 == 0) {
                // Send SIGHUP signal to the child
                kill(pid, SIGHUP);
                printf("Parent sent SIGHUP signal\n");
            } else {
                // Send SIGINT signal to the child
                kill(pid, SIGINT);
                printf("Parent sent SIGINT signal\n");
            }
            sleep(3);  // Wait for 3 seconds before sending the next signal
        }

        // After 30 seconds, send SIGQUIT signal to child
        sleep(3);  // Wait 3 more seconds before sending SIGQUIT (total 30 seconds)
        kill(pid, SIGQUIT);
        printf("Parent sent SIGQUIT signal. Child will terminate.\n");

        // Wait for the child to terminate
        wait(NULL);
    }

    return 0;
}
