Slip 6

Q.1] Create a web page being rendered in the browser consists of many things - 
 logo, informative text, pictures, hyperlinks, navigational structure and table. 
1. Model the following information as a document database.
A customer can take different policies and get the benefit. There are
different types of policies provided by various companies
2. Assume appropriate attributes and collections as per the query
requirements.  
3. Insert at least 5 documents in each collection.  
4. Answer the following Queries.
a. List the details of customers who have taken “Komal Jeevan” Policy
b. Display average premium amount  
c. Increase the premium amount by 5% for policy type=”Monthly”
d. Count no. of customers who have taken policy type “half yearly”.

Ans -

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insurance Policy Information</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #4CAF50;
            padding: 20px;
            text-align: center;
            color: white;
        }
        header img {
            width: 150px;
            height: auto;
        }
        nav {
            background-color: #333;
            overflow: hidden;
        }
        nav a {
            float: left;
            display: block;
            color: white;
            padding: 14px 20px;
            text-align: center;
            text-decoration: none;
        }
        nav a:hover {
            background-color: #ddd;
            color: black;
        }
        .container {
            padding: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid black;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        img {
            width: 100%;
            max-width: 500px;
            height: auto;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <!-- Header with Logo and Title -->
    <header>
        <img src="https://via.placeholder.com/150" alt="Company Logo">
        <h1>Welcome to Insurance Policy Portal</h1>
    </header>

    <!-- Navigation Bar -->
    <nav>
        <a href="#home">Home</a>
        <a href="#policies">Policies</a>
        <a href="#customers">Customers</a>
        <a href="#contact">Contact</a>
    </nav>

    <!-- Main Content -->
    <div class="container">
        <h2>Informative Text About Policies</h2>
        <p>Our company offers a range of policies to meet your needs. Choose from life, health, and investment policies.</p>

        <h3>Our Featured Policies</h3>
        <p>Explore our various policy types that ensure your safety and financial future. We offer life insurance, health coverage, and more.</p>

        <img src="https://via.placeholder.com/500x300" alt="Insurance Image">

        <!-- Customer Table -->
        <h3>Customer Policy Details</h3>
        <table>
            <thead>
                <tr>
                    <th>Customer Name</th>
                    <th>Policy Type</th>
                    <th>Premium Amount</th>
                    <th>Policy Duration</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>John Doe</td>
                    <td>Komal Jeevan</td>
                    <td>15000</td>
                    <td>1 Year</td>
                </tr>
                <tr>
                    <td>Jane Smith</td>
                    <td>Health Secure</td>
                    <td>12000</td>
                    <td>2 Years</td>
                </tr>
                <tr>
                    <td>Robert Brown</td>
                    <td>Komal Jeevan</td>
                    <td>18000</td>
                    <td>1 Year</td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <!-- MongoDB Schema and Queries -->
    <script>
        // Assuming MongoDB is running and db variable is initialized

        // Create collections for customers and policies
        db.createCollection("customers");
        db.createCollection("policies");
        db.createCollection("policy_benefits");

        // Insert customers
        db.customers.insertMany([
            { name: "John Doe", contact: "1234567890", email: "johndoe@example.com" },
            { name: "Jane Smith", contact: "2345678901", email: "janesmith@example.com" },
            { name: "Robert Brown", contact: "3456789012", email: "robertbrown@example.com" },
            { name: "Emily Davis", contact: "4567890123", email: "emilydavis@example.com" },
            { name: "Sarah Lee", contact: "5678901234", email: "sarahlee@example.com" }
        ]);

        // Insert policies
        db.policies.insertMany([
            { policy_name: "Komal Jeevan", policy_type: "Life", premium_amount: 15000, duration: 12, customer_ids: ["John Doe", "Robert Brown"] },
            { policy_name: "Health Secure", policy_type: "Health", premium_amount: 12000, duration: 24, customer_ids: ["Jane Smith"] },
            { policy_name: "Investment Plan", policy_type: "Investment", premium_amount: 20000, duration: 36, customer_ids: ["Emily Davis"] },
            { policy_name: "Senior Care", policy_type: "Life", premium_amount: 18000, duration: 24, customer_ids: ["Sarah Lee"] },
            { policy_name: "Family Insurance", policy_type: "Health", premium_amount: 15000, duration: 12, customer_ids: ["John Doe"] }
        ]);

        // Insert policy benefits
        db.policy_benefits.insertMany([
            { policy_name: "Komal Jeevan", benefits: ["Life Coverage", "Tax Savings"] },
            { policy_name: "Health Secure", benefits: ["Medical Coverage", "Emergency Benefits"] },
            { policy_name: "Investment Plan", benefits: ["High Returns", "Tax Benefits"] },
            { policy_name: "Senior Care", benefits: ["Life Coverage", "Medical Benefits"] },
            { policy_name: "Family Insurance", benefits: ["Medical Coverage", "Family Protection"] }
        ]);

        // Queries

        // a) List the details of customers who have taken “Komal Jeevan” Policy
        db.policies.find({ policy_name: "Komal Jeevan" }).forEach(function(doc) {
            print("Customers with Komal Jeevan Policy:");
            doc.customer_ids.forEach(function(customer) {
                let customerData = db.customers.findOne({ name: customer });
                print("Name: " + customerData.name + ", Email: " + customerData.email);
            });
        });

        // b) Display the average premium amount for all policies
        db.policies.aggregate([
            { $group: { _id: null, average_premium: { $avg: "$premium_amount" } } }
        ]);

        // c) Increase the premium amount by 5% for policy type="Monthly"
        db.policies.updateMany(
            { policy_type: "Monthly" },
            { $mul: { premium_amount: 1.05 } }
        );

        // d) Count the number of customers who have taken a policy type “half yearly”
        let policyType = "half yearly";
        let policyData = db.policies.find({ policy_type: policyType }).toArray();
        let customerCount = 0;

        policyData.forEach(function(policy) {
            customerCount += policy.customer_ids.length;
        });

        print("Number of customers with " + policyType + " policies: " + customerCount);
    </script>

</body>
</html>
